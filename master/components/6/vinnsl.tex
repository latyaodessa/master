\section{Vienna Neural Network Specification Language}\label{ViNNSL 2.0 extended}

In this chapter will be described the history if the ViNNSL language, its development and new features, which are applied in the current N2Sky system.

\subsection{ViNNSL Development}\label{ViNNSL Development}
Vienna Neural Network Specification Language (ViNNSL) is the language, which used for for description of the semantic and behaviour of the neural network paradigm. ViNNSL gives possibility to create dynamic services, which can differentiate the behaviour. The ViNNSL seen as a semantic language standard. The language uses schemas, which helps users to describe attributes like service capabilities, semantic, functions and parameters \cite{Beran2008}.

ViNNSL consist of five parts:
\begin{itemize}
\item Description Schema
\item Definition Schema
\item Data Schema
\item Result Schema
\end{itemize}

This approach with multiple schemas was used in Neural Network Cube (N2Grid) System. This system is a web based neural network simulator used by students and researchers \cite{schikuta2004n2grid}. Today N2Sky is the follower of the N2Grid ideas. 

In 2015 the ViNNSL 2.0 was released, which was the extension of the previous version \cite{ijcnn15}. Basically almost nothing changed only additional fields were added:
\begin{itemize}
\item \emph{Creator}
\item \emph{Problem Domain}
\item \emph{Propagation Type}
\item \emph{Learning Type}
\item \emph{Application Field}
\item \emph{Network Type}
\item \emph{Problem Type}
\item \emph{Execution Environment} The idea was proposed back then by the concept of the N2Grid \cite{schikuta2004n2grid}. It is possible to define the environment, which is needed for particular neural network instance. 
\item \emph{Execution Type.} It became possible to define how neural network will be executed either sequential or parallel. In detailed it was possible to define perform processing and the type of the architecutre.
\item \emph{Result Schema} became a part of the ViNNSL Description. Earlier it was separated schema, but data schema and instance schema still remain the same.
\item \emph{Parameters} The user could define input as well as output parameters. It was possible to define also file for nerual network training.
\end{itemize}

\subsection{ViNNSL Template}\label{ViNNSL Template}

After studying ViNNSL with its extension it was decided to simplify the whole schemas and most importantly adapt it to current N2Sky system.

The idea behind to use the ViNNSL template, which has additional fields for ViNNSL 2.0, but they can be fully processed and taking away after creating the neural network. No more extra objects or fields in other application. ViNNSL template allows user to apply the ViNNSL language across the whole N2Sky platform. The detailed information is shown in \autoref{A}

\subsubsection{Metadata template}\label{Metadata template}

As it was mentioned before, the ViNNSL 2.0 contains metadata about user and neural network.

\begin{lstlisting}
...
	"problemDomain": {
		"propagationType": {
			"value": null,
			"possibleValues": ["feedforward"],
			"learningType": {
				"value": null,
				"possibleValues": ["definedconstructed", 
				"trained", "supervised", "usupervised", "linear"]
			}
		},
		"applicationField": {
			"value": null,
			"possibleValues": ["AccFin", "HealthMed", "Marketing",
			 "Retail", "Insur", "Telecom", "Operations", "EMS"]
		},
		"problemType": {
			"value": null,
			"possibleValues": ["Classifiers", "Approximators",
			 "Memory", "Optimisation", "Clustering"]
		},
		"networkType": "Backpropagation"
	}
...
\end{lstlisting}

From code above it is possible to spot some additional values:
\begin{itemize}
\item \emph{value} is the default value of the object. 
\item \emph{possibleValues} parameter, which contains the array of possible value. The user can choose one of the value. 
\end{itemize}

This approach not only helps to add templating into current ViNNSL schema, but also add some rules upon it:
\begin{itemize}
\item If default value set and there is no more values under "possibleValues" parameter, then the value is impossible to change.
\item If there is no value for "possibleValues" and "value" fields, than the user can type customised value.
\item If the "value" has some parameter and "possibleValues" field is also not empty it means that the "value" parameter is the default value and it can be changed by "possibleValues".
\end{itemize}

\subsubsection{Environment}\label{Environment}

In previous versions of the ViNNSL language it was possible to define execution environment. This possibility is still available, but some additional value were added in order to apply templating. 

In current version of N2Sky it is possible to deploy neural network on N2Sky cloud as well as on private cloud of the user. That is was the "endpoints" parameter was added.

\begin{lstlisting}
...
	"endpoints": [{
		"name": "train",
		"endpoint": null
	}, {
		"name": "test",
		"endpoint": null
	}]
...
\end{lstlisting}

Since it is array parameter it gives room for adding new endpoints in case if it will be needed in future versions of the N2Sky.

\subsubsection{Neural Network Structure Template}\label{Neural Network Structure Template}

The structure of the neural network was also changed. The template looks pretty empty, but from this template is possible to generate any type of structure based on ViNNSL language. 

\begin{lstlisting}
...
"structure": {
		"inputLayer": {
			"result": {
				"nodesId": []
			},
			"config": {
				"dimensions": {
					"min": 1,
					"max": 1
				},
				"size": {
					"min": 960,
					"max": 960
				}
			}
		},
		"hiddenLayer": {
			"result": {
				"dimensions": [{
					"id": null,
					"nodesId": []
				}]
			},
			"config": {
				"dimensions": {
					"min": 1,
					"max": 1
				},
				"size": {
					"min": 960,
					"max": 960
				}
			}
		},
		"outputLayer": {
			"result": {
				"nodesId": []
			},
			"config": {
				"dimensions": {
					"min": 1,
					"max": 1
				},
				"size": {
					"min": 960,
					"max": 960
				}
			}
		},
...
\end{lstlisting}

The structure contains input, hidden and output layer. Hidden layer has "dimensions" parameter, which allows to create multiple hidden layers.

 Every layer layer has "config" property, which shows how many dimensions is possible to use. This config is scalable, it is possible to add additional configuration or use none of them.
 
 Additionally every layer has number of nodes, namely the neutrons id.  
 
 In structure is important to define the connections between nodes. 
 
 \begin{lstlisting}
...
		"connections": {
			"fullyConnected": {
				"isConnected": null
			},
			"shortcuts": {
				"isConnected": null,
				"connections": [{
					"from": null,
					"to": null,
					"isFullConnected": null
				}]
			}
		}
	}
...
\end{lstlisting}

There are few types of connections:
\begin{itemize}
\item \emph{fullyConnected} parameter, which has boolean "isConnected" in case if the neural network fully connected or not.
\item \emph{shortcuts} is a parameter, which also has boolean flag parameter. If there are any types of the shortcuts is will be set on true. Inside of this parameter is an array field "connections". This array has from and to node id parameter and in case if the full connection remains the same this "isFullConnected" will set on true.
\end{itemize}

\subsubsection{Parameters Template}\label{Parameters Template}

To  the input parameters the templating was also applied. The structure of the template is pretty similar to metadata template.

 \begin{lstlisting}
...
"parameters": {
		"input": [
			{
				"parameter": "activationFunction",
				"defaultValue": "sigmoid",
				"possibleValues": ["sigmoid", "relu", "softmax"]
			},
			{
				"parameter": "activationFunctionHidden",
				"defaultValue": "relu",
				"possibleValues": ["sigmoid", "relu"]
			},
...
\end{lstlisting}

Additionally in this template used the "parameter" field. This field define actual input parameter and has to be unique.

The output parameter is fixed and can not be changed. This parameter will be used for trained model evaluation in case if the user does not want to type own testing data.

The training file information also defined under parameters and can be changed only by neural network owner.


\subsection{ViNNSL Generation}\label{ViNNSL Generation}

After the neural network contributor user fill out the template ViNNSL it is possible to generate the ViNNSL Description schema. This schema will be used for neural network training. The generation is happening  on N2Sky platform and the ViNNSL Description file can be totally different, but the rules will be followed. The user now has possibility to customise the structure, connection, metadata and parameters of the neural network. It is impossible to do something wrong, because permissions are restricted by ViNNSL Template. 

The contributor user  can also user ViNNSL in order to fill out structure, connection, metadata and parameters of the neural network. If the user manually will do it, without N2Sky "3-step-view" generator, he has to upload his ViNNSL in N2Sky platform and the neural network will be automaticly created. 

\subsubsection{Generated metadata}\label{Generated metadata}

In generated metadata the information is filled out from N2Sky platform.

All unless fields will be removed automatically, even if the contributor user leave it there. The typical parameters like "possibleValues" will be removed everywhere except the training parameters, because it is needed for performing training.

 \begin{lstlisting}
 ...
	"problemDomain": {
		"problemType": "Classifiers",
		"networkType": "Backpropagation",
		"applicationField": [
			"AccFin"
		],
		"propagationType": {
			"propType": "feedforward",
			"learningType": "supervised"
		}
	},
	"creator": {
		"name": "fedorenko",
		"contact": "andriifedorenko@gmail.com"
	},
	"metadata": {
		"name": "XOR Test",
		"description": "test",
		"paradigm": "Backpropagation",
...
\end{lstlisting}

The detailed information is shown in \autoref{B}

\subsubsection{Generated structure}\label{Generated structure}

The structure is the most complicated part of the ViNNSL generation if the user will do it manually without N2Sky generator. 

Every node will receive the id, which will be parsed by N2Sky.

\begin{itemize}
\item \emph{Input layer as well as output layer} has the same structure of the node ids.
 \begin{lstlisting}
...
		"inputLayer": {
			"amount": 3,
			"nodesId": [
				"1-input",
				"2-input",
				"3-input"
			]
		},
		"outputLayer": {
			"amount": 1,
			"nodesId": [
				"1-output"
			]
		},
...
\end{lstlisting}

Every node has the amount of the nodes. The nodes id have following structure: 
\begin{enumerate}
\item The unique id of the node, which also define the order
\item The name of the layer
\end{enumerate}
\item \emph{The hidden layer} can be multidimensional, that is why the id of the layer as well as id of nodes are required.

 \begin{lstlisting}
...
		"hiddenLayer": [
			{
				"id": "1-hidden-layer",
				"amount": 4,
				"nodesId": [
					"1-node-1-hidden-layer",
					"2-node-1-hidden-layer",
					"3-node-1-hidden-layer",
					"4-node-1-hidden-layer"
				]
			},
...
\end{lstlisting}

The id of the layer dined by the first number, which is also the order of the layer.

The id of the nodes defined by following rules:
\begin{enumerate}
\item The unique id of the node, which also define the order
\item The id of the layer
\item The name of the layer
\end{enumerate}

\end{itemize}


\subsection{ViNNSL Model}\label{ViNNSL Model}

The ViNNSL Model is a derived from ViNNL Description trained model. Basically the input parameters were taken from the ViNNSL Description and default values were replaced with the trained data. Additionally it was decided to put following parameters:

\begin{itemize}
\item \emph{rawModel} is the raw training model, which can be used for the model evaluation. 
\item \emph{logs.} The logs are appending during the training. When the training done the logs will be removed from neural network and added as a parameter to the model.
\item \emph{test} is the array of performed tests. It was decided to save the test results in the model in order to stop spreading multiple schemas. 
 \begin{lstlisting}
...
       {
                "createdOn": "2018-02-24T12:24:38.198Z",
                "result": "[[0.]\n [1.]\n [1.]\n [1.]]",
                "testing_data": "[[0,0],[0,1],[1,0],[1,1]]",
                "user": "admin"
            }
 ...
\end{lstlisting}
The test has following data:
\begin{itemize}
\item \emph{createdOn} timestamp of the testing
\item \emph{testing\_data} with which the model was tested
\item \emph{result} actual result of the testing
\item \emph{user} the user, who performed test.
\end{itemize}
\item \emph{paramters} the input parameters, where default values were replaced with the actual values. 
\end{itemize}

Detailed example of the ViNNSL model is located in \autoref{C}
